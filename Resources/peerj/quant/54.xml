<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN" "JATS-journalpublishing1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article" dtd-version="1.0">
  <front>
    <journal-meta>
      <journal-id journal-id-type="pmc">PeerJ</journal-id>
      <journal-id journal-id-type="nlm-ta">PeerJ</journal-id>
      <journal-id journal-id-type="publisher-id">PeerJ</journal-id>
      <journal-title-group>
        <journal-title>PeerJ</journal-title>
      </journal-title-group>
      <issn pub-type="epub">2167-8359</issn>
      <publisher>
        <publisher-name>PeerJ Inc.</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">54</article-id>
      <article-id pub-id-type="doi">10.7717/peerj.54</article-id>
      <article-categories>
        <subj-group subj-group-type="categories">
          <subject>Agricultural Science</subject>
          <subject>Bioinformatics</subject>
          <subject>Veterinary Medicine</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Quantifying inter-group variability in lactation curve shape and magnitude with the MilkBot<sup>®</sup> lactation model</article-title>
      </title-group>
      <contrib-group content-type="authors">
        <contrib id="author-1" contrib-type="author" corresp="yes">
          <name>
            <surname>Ehrlich</surname>
            <given-names>James L.</given-names>
          </name>
          <xref ref-type="aff" rid="aff-1"/>
          <email>jehrlich@dairyvets.com</email>
        </contrib>
        <aff id="aff-1"><institution>Dairy Veterinarians Group</institution>, <addr-line>Argyle, NY</addr-line>, <country>USA</country></aff>
      </contrib-group>
      <contrib-group content-type="editors">
        <contrib id="editor-1" contrib-type="editor">
          <name>
            <surname>Uversky</surname>
            <given-names>Vladimir</given-names>
          </name>
        </contrib>
      </contrib-group>
      <pub-date pub-type="epub" date-type="pub" iso-8601-date="2013-03-12">
        <day>12</day>
        <month>3</month>
        <year iso-8601-date="2013">2013</year>
      </pub-date>
      <volume>1</volume>
      <elocation-id>e54</elocation-id>
      <history>
        <date date-type="received" iso-8601-date="2013-01-22">
          <day>22</day>
          <month>1</month>
          <year iso-8601-date="2013">2013</year>
        </date>
        <date date-type="accepted" iso-8601-date="2013-03-01">
          <day>1</day>
          <month>3</month>
          <year iso-8601-date="2013">2013</year>
        </date>
      </history>
      <permissions>
        <copyright-statement>© 2013 Ehrlich</copyright-statement>
        <copyright-year>2013</copyright-year>
        <copyright-holder>Ehrlich</copyright-holder>
        <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/3.0/">
          <license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <self-uri xlink:href="https://peerj.com/articles/54"/>
      <abstract>
        <p>Genetic selection programs have driven development of most lactation models, to estimate the magnitude of animals’ productive capacity from sampled milk production data. There has been less attention to management and research applications, where it may also be important to quantify the <bold>shape</bold> of lactation curves, and predict future daily milk production for incomplete lactations since residuals between predicted and actual daily production can be used to quantify the response to an intervention. A model may decrease the confounding effects of lactation stage, parity, breed, and possibly other factors depending on how the model is constructed and used, thus increasing the power of statistical analyses. Models with a mechanistic derivation may allow direct inference about biology from fitted production data. The MilkBot<sup>®</sup> lactation model is derived from abstract suppositions about growth of udder capacity. This permits inference about shape of the lactation curve directly from parameter values, but not direct conclusions about physiology. Individual parameters relate to the overall <bold><italic>scale</italic></bold> of the lactation, the <bold><italic>ramp</italic></bold>, or rate of growth around parturition, <bold><italic>decay</italic></bold> describing the senescence of productive capacity (inversely related to <bold><italic>persistence</italic></bold>), and the relatively insignificant time <bold><italic>offset</italic></bold> between calving and the physiological start of milk secretion. A proprietary algorithm was used to fit monthly test data from two parity groups in 21 randomly selected herds, and results displayed in box-and-whisker charts and Z-test tables. Fitted curves are constrained by the MilkBot<sup>®</sup> equation to a single peak that blends into an exponential decline in late lactation. This is seen as an abstraction of productive capacity, with actual daily production higher or lower due to random error plus short-term environmental effects. The four MilkBot<sup>®</sup> parameters, and metrics calculated directly from them including fitting error, peak milk and cumulative production, can be used to describe and compare individual lactations or groups of lactations. There is considerable intra-herd and inter-herd variability in <italic>scale, ramp, decay</italic>, RMSE, peak milk, and cumulative production, suggesting that management and environment have significant influence on both shape and magnitude of normal lactation curves.</p>
      </abstract>
      <kwd-group kwd-group-type="author">
        <kwd>Lactation curve</kwd>
        <kwd>Persistency</kwd>
        <kwd>MilkBot</kwd>
        <kwd>Dairy management</kwd>
        <kwd>Lactation</kwd>
      </kwd-group>
      <funding-group>
        <award-group id="fund-1">
          <funding-source>USDA National Institute for Food and Agriculture (NIFA)</funding-source>
          <award-id>SBIR grant 2008-33610-18962</award-id>
        </award-group>
        <funding-statement>Data used in this study was acquired from Dairy Records Management Systems (Raleigh, NC, and Ames, IA) under SBIR grant 2008-33610-18962 from the USDA National Institute for Food and Agriculture (NIFA). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
    </article-meta>
  </front>
  <body>
    <sec>
      <title>Background</title>
      <p>Lactation models typically predict milk production, or a milk component, as a function of DIM (<italic>days in-milk)</italic>. They may be classified by several criteria that have important implications for their usefulness in applications. First, models may be classified as mechanistic or empirical based on their derivation and objectives. For example <xref ref-type="bibr" rid="ref-6">Dijkstra et al. (1997)</xref> and <xref ref-type="bibr" rid="ref-11">Pollott (2000)</xref> each describe a mechanistic model developed from data and assumptions about cell populations in mammary tissue, from which inferences can be made about milk production. Because of this derivation, data about milk production can also lead back to inferences about physiology through the construct of the model. In contrast, empirical models such as Best Prediction (<xref ref-type="bibr" rid="ref-3">Cole &amp; VanRaden, 2006</xref>) and many other systems developed for estimating genetic value of bulls from the records of their daughters are content with predicting milk production without any hypothetical linkage to the biology of lactation. The seminal Wood model (<xref ref-type="bibr" rid="ref-14">Wood, 1967</xref>) was introduced without a mechanistic derivation, though the portion of the model controlling senescence (identical to the corresponding part of the MilkBot<sup>®</sup> model and several other models) can be interpreted mechanistically.</p>
      <p>For both mechanistic and empirical models it is often desirable to fit production data to the model generating a set of fitted parameter values describing a lactation curve. For linear models, or models like Best Prediction, which fits a linear adjustment to a nonlinear base, linear regression yields a simple and reliable fitting method. Some widely used polynomial models also are easily fitted (<xref ref-type="bibr" rid="ref-13">Schaeffer et al., 2000</xref>), but may present other difficulties. Fitting methods are less straightforward for most other nonlinear functions. For models that may be transformed mathematically to a linearized form, like the Wood model, linear regression can still be used, but the solution is not very satisfactory because the transformation of raw data means the result is no longer a true least-squares fit. Many techniques exist for true least-squares optimization of nonlinear models, but matching a model and fitting method in a way that generates consistently reliable results is complicated by characteristics of both model and data. Despite this difficulty, increased computing power, and improvements in nonlinear fitting methods, have made nonlinear models a practical alternative for fitting both individual and aggregated lactations. Fitting of nonlinear models often involves iterative algorithms for which it cannot be guaranteed that solutions are unique, optimal, or even findable. This means that extensive and varied testing is required to evaluate the robustness of a nonlinear model-and-fitting-method pair when applied to data sets of various kinds. A model which accurately reflects the mechanism behind the data is often more robust because the mathematics of the model naturally constrains solutions to those which are biologically probable.</p>
      <p>The question of what constitutes an optimal fit deserves more attention than it sometimes receives. The usual assumption is that the best fit minimizes the sum of squares of residuals, often referred to as mean square error (MSE), or its square root, RMSE (root mean square error). It can be argued that this solution is most likely to be correct if error is normally distributed and there is no prior information about the population being measured. In reality, we have a great deal of information on what normal lactations look like, and how they vary with factors such as breed, parity, region, and so on. Maximum likelihood methods incorporate some of this prior information on expected frequency of solutions along with the test data during optimization, to arrive at solutions that are more likely to reflect reality, despite MSE that is normally higher than obtainable by minimizing MSE strictly, especially if there are few data points.</p>
      <p>Data to be fitted may be from a single lactation, or aggregated data from some grouping of multiple lactations in which case the curve should be called an <bold><italic>aggregate lactation curve</italic></bold>. Aggregated data is influenced by population effects in addition to individual lactation effects so that studies on aggregated data are not completely comparable to studies based on fitting of individual lactations. For example management policies for culling usually depend on relative production of individuals, so that higher merit individuals may be over-represented in late lactation. This could cause an upward deflection of aggregate data in late lactation, as is sometimes seen (<xref ref-type="bibr" rid="ref-7">Ehrlich, 2011</xref>; <xref ref-type="bibr" rid="ref-5">Dematawewa, Pearson &amp; VanRaden, 2007</xref>), without a matching deflection in individual lactations. Many such hidden population effects are possible, so it should not be assumed that the model that best fits aggregated data also fits individual lactations best. Aggregation of data also may either decrease or increase MSE, depending on whether aggregation is done before or after fitting. For example,  <xref ref-type="bibr" rid="ref-5">Dematawewa, Pearson &amp; VanRaden (2007)</xref> fitted single curves to data points from multiple lactations, which would be expected to increase MSE relative to individual lactations because of added variability between lactations. <xref ref-type="bibr" rid="ref-7">Ehrlich (2011)</xref> fitted a large data set aggregated by DIM before fitting, which decreased MSE to very low levels. Either of these approaches can be supported, but the meaning of MSE values is altered radically.</p>
      <p>Applications of lactation models vary widely. Much work has been done with the objective of obtaining an estimate of the genetic value of milking animals and their sires, notably at the USDA Animal Improvement Programs Laboratory (USDA-AIPL) (<xref ref-type="bibr" rid="ref-1">Animal Improvement Programs: Home, 2012</xref>) in Beltsville, MD and by other members of the International Bull Evaluation Service, <xref ref-type="bibr" rid="ref-10">“Interbull” (2012)</xref>. For this application, models may adjust for effects of lactation stage, breed, parity, season, and region on production, and environmental effects are seen as confounding variables, while the main point of interest is an individual animal’s productive capacity. For management purposes, though, it is often the environmental effects that are the variables of interest. For example a dairyman may want to know the effect of a change in transition management or a researcher the effect of a feed additive. Changes in the distribution of milk within lactations, i.e. the shape of the curve, may be more sensitive and specific in measuring effects of short-term changes such as illness, feeding, or housing, but these can only be quantified if model parameters relate to curve shape in a consistent way. This was demonstrated by <xref ref-type="bibr" rid="ref-9">Hostens et al. (2012)</xref> in a study of relations between metabolic diseases and milk production. Looking at raw milk production data or M305 (cumulative milk production for the first 305 days of a lactation), no statistically significant relations were found, but there were multiple significant or highly significant relations between diseases and parameter values for individual lactations fitted to the MilkBot<sup>®</sup> model. Transition period diseases tended to hurt the <italic>ramp</italic> of the lactation, but there was a compensatory increase in persistency leading to little net change in M305. Through the model, these effects on the distribution of production within the lactation could be quantified as changes to fitted parameter values of individual lactations.</p>
      <p>A model fitted to individual lactations sometimes can be used to predict daily milk production, and study the effect of management and environment on milk production through analysis of residuals. Residuals, that is the difference between expected and observed daily milk production, can be attributed to factors outside the model domain such as feeding, illness, the environment, or some management intervention. Model residuals minimize the confounding effect of DIM on production, without the smoothing effect of choosing a cumulative metric like M305.</p>
      <p>The MilkBot<sup>®</sup> model has been used with the Levenburg-Marquardt fitting algorithm to fit aggregate lactation curves for major breeds and parities (<xref ref-type="bibr" rid="ref-7">Ehrlich, 2011</xref>). The proprietary DairySight genetic algorithm is also available online (<xref ref-type="bibr" rid="ref-8">Ehrlich, 2012</xref>) to fit individual lactations to the MilkBot<sup>®</sup> model. This uses a maximum likelihood algorithm to return a solution even with no data points, in which case population mean parameter values will be returned. As more data points become available, they are combined with the <italic>a priori</italic> information, and individual solutions will diverge from population means. This means that sensitivity and specificity of the fit to real differences between lactations will increase as more data points are used. While the process obviously cannot detect differences in parts of the curve where there are no data points, a stable solution is achieved in nearly all cases, and solutions are usually insensitive to small changes to data points. <xref ref-type="bibr" rid="ref-4">Cole, Ehrlich &amp; Null (2012)</xref>, <xref ref-type="bibr" rid="ref-9">Hostens et al. (2012)</xref> and <xref ref-type="bibr" rid="ref-2">Charlier et al. (2012)</xref> used the DairySight fitting engine successfully in fitting individual lactations from monthly test data.</p>
      <p>No model is perfect, nor is testing ever complete. Relative performance of models may depend on details of the population studied and what data is used. Normal production curves may vary by breed, parity, and other groupings, and may change over time, so testing should be continuous and in multiple forms. One basic test is to make appropriately blinded predictions based on the model and tabulate statistics on prediction error. <xref ref-type="bibr" rid="ref-4">Cole, Ehrlich &amp; Null (2012)</xref> showed that MilkBot<sup>®</sup> predications were usually more accurate and precise than three other lactation models by calculating mean and standard deviation of error in predicting next-test milk as a function of DIM. A more general test is simply to see whether application of a model leads to useful results. In this way, hundreds of papers on genetic selection of cattle using lactation models, and the dramatic improvements in milk production of dairy cattle they facilitated testify to the utility of AIPL and Interbull models. Similarly, recent papers by <xref ref-type="bibr" rid="ref-9">Hostens et al. (2012)</xref> and <xref ref-type="bibr" rid="ref-2">Charlier et al. (2012)</xref> testify to the utility of the MilkBot<sup>®</sup> model in measuring management effects.</p>
      <p>That management, breed, and parity influence <italic>magnitude</italic> of production is obvious, and can be measured by M305, peak milk, or similar metrics, but little is known about variability in lactation curve <italic>shape</italic>, except that first-parity animals typically show greater persistency and lower peak milk than older cows. It is often assumed that curve shape is biologically fixed, and that management influences magnitude only, but this assumption may be a consequence the difficulty of quantifying shape. Quantification of lactation curve shape, or the distribution of production within a lactation, is hampered by lack of a standard methodology and terminology. For example there is no standard quantitative definition of “persistency” in general usage, and no generally accepted quantitative metric of the rate of rise in early lactation that within the MilkBot<sup>®</sup> model is called <italic>ramp</italic>.</p>
      <p>Development of the MilkBot<sup>®</sup> lactation model was driven by the belief that management of dairy herds influences the shape of lactation curves, and that those differences can be measured statistically as a means of studying effects of management and environment on milk production. The null hypothesis, in that context, is that lactation curve shape does <bold>not</bold> vary significantly between dairy herds and parity groups, or that if such variability exists the MilkBot<sup>®</sup> model provides no benefit in detecting and quantifying that variability. An important secondary objective is to provide background information for experimental design and the building of specific hypotheses about effects of management and environment on lactation curve shape. Because no data was available on management of individual groups and herds, such causal relationships are entirely speculative in this study.</p>
    </sec>
    <sec sec-type="methods">
      <title>Methods</title>
      <sec>
        <title>Development of the MilkBot<sup>®</sup> model</title>
        <p><xref ref-type="bibr" rid="ref-12">Rook, France &amp; Dhanoa (1993)</xref> describe a general lactation model consisting of a growth process multiplied by a death process and a scalar. They stipulate that both growth and death processes should be monotonic, with the growth function rising from zero to approach one, and the death function decreasing from one to approach zero. These constraints have the important effect of making the scalar largely responsible for magnitude of the curve with the growth function dominating shape of the rising portion of a normal lactation curve, and the death function dominating the decline in late lactation, or decay portion of the curve. Note that the growth function returns the cumulative growth as a function of time, not the <italic>rate</italic> of growth. This may be inferred from the constraints. The multiplicative variant of the Pollot mechanistic model  (<xref ref-type="bibr" rid="ref-11">Pollott, 2000</xref>) follows this general model, but the frequently cited <xref ref-type="bibr" rid="ref-14">Wood (1967)</xref> lactation model, while otherwise similar to the general model, has no upper limit to the growth function, which results in the scaling of the lactation curve being shared between the scalar and the growth process.</p>
        <p>In developing the MilkBot<sup>®</sup> model, we accept the constraints of the Rook general model and begin by extending it backwards, defining a <bold>Growthrate Function</bold>, <italic>C</italic>(<italic>t</italic>) which models the rate of creation of lactational capacity. This means the Growth function will be the integral of the Growthrate function, and Growthrate will be the derivative of Growth. <xref ref-type="disp-formula" rid="eqn-1">Equation (1)</xref> states the general model as defined, and extended, where <italic>Y</italic>(<italic>t</italic>) represents milk production on day <italic>t</italic> of a lactation with scalar <italic>a</italic> and <italic>G</italic>(<italic>t</italic>), <italic>D</italic>(<italic>t</italic>), and <italic>C</italic>(<italic>t</italic>) representing growth, death, and Growthrate functions. <disp-formula id="eqn-1"><label>(1)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-1.png"/><tex-math id="tex-eqn-1"><![CDATA[\begin{eqnarray} \displaystyle Y(t)=a G(t)~D(t)=a\int \nolimits \nolimits _{-\infty }^{t}C(t)d t~D(t).&&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-1"><mml:mstyle displaystyle="true"><mml:mi>Y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>G</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mspace class="nbsp"/><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mspace class="nbsp"/><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> To maintain conformity with standard practices, the model’s independent variable, <italic>t</italic>, represents DIM, with <italic>t</italic> = 1 at parturition, but in a further extension of the general model, and contrary to current standard practice, we note that parturition and the start of lactation are separate events, though related. We define the start of lactation as the midpoint of growth in production capacity, and an <italic>offset</italic> variable, <italic>c</italic>, which is the time between parturition and that growth midpoint (the start of lactation). Therefore <italic>G</italic>(<italic>t</italic>) = 1/2 when <italic>t</italic> = <italic>c</italic> by definition.</p>
        <p>Though <italic>C</italic>(<italic>t</italic>) is not strictly a probability distribution, it is similarly constrained, with the full-range integral equal to 1. The most prominent probability distribution, the normal distribution, is an obvious candidate for <italic>C</italic>(<italic>t</italic>), which would require the rate of creation of udder capacity to rise in a bell curve to a peak near parturition, and then fall again. This has the advantage of being at least moderately credible in relation to observable growth of udder tissue, and easily described by two familiar parameters corresponding to the standard deviation of the Normal curve and the offset location parameter.</p>
        <p>The integral of the Normal distribution, the Cumulative Normal function, can only be calculated as an improper integral, which adds considerable mathematical complication. Therefore, simply as a concession to ease of computation, MilkBot<sup>®</sup> uses an approximation, the Laplace distribution, for <italic>C</italic>(<italic>t</italic>), because it is easily integrated, while yielding a curve of similar shape. The Laplace distribution takes different mathematical forms for left and right sides of the curve, but since the peak is expected to be at or near parturition, and we are unconcerned with the shape of growth before milking commences, the left side of the function can safely be dropped (<xref ref-type="disp-formula" rid="eqn-2">Eq. (2)</xref>). This is equivalent mathematically to postulating that growth rate of udder capacity decreases exponentially from a peak that defines the start of lactation, and with enough high quality data it might be possible to discern whether an exponential or Gaussian growth rate function is closer to reality, but differences between the two are very small after the two weeks of lactation. The resulting growth function (<xref ref-type="disp-formula" rid="eqn-3">Eq. (3)</xref>) ends up mathematically equivalent to the Mitscherlich function described by <xref ref-type="bibr" rid="ref-12">Rook, France &amp; Dhanoa (1993)</xref>, but with a different parameterization which emphasizes similarity with the initial Gaussian model. <disp-formula id="eqn-2"><label>(2)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-2.png"/><tex-math id="tex-eqn-2"><![CDATA[\begin{eqnarray} \displaystyle C\left(t\right)=\frac{1}{2~b}\exp \left(\frac{c-t}{b}\right)\quad \text{where}~t\gt c\quad \text{(Laplace distribution)}&&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-2"><mml:mstyle displaystyle="true"><mml:mi>C</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mspace class="nbsp"/><mml:mi>b</mml:mi></mml:mrow></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mspace width="1em" class="quad"/><mml:mtext>where</mml:mtext><mml:mspace class="nbsp"/><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi><mml:mspace width="1em" class="quad"/><mml:mtext>(Laplace distribution)</mml:mtext></mml:mstyle></mml:math></alternatives></disp-formula>  
               <disp-formula id="eqn-3"><label>(3)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-3.png"/><tex-math id="tex-eqn-3"><![CDATA[\begin{eqnarray} \displaystyle G\left(t\right)=\int \nolimits \nolimits _{-\infty }^{t}C(t)~d t=1-\frac{\exp \left(\frac{c-t}{b}\right)}{2}.&&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-3"><mml:mstyle displaystyle="true"><mml:mi>G</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>∫</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mspace class="nbsp"/><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
            </p>
        <p>For a <bold>Death Function</bold>, <italic>D</italic>(<italic>t</italic>), we choose the same exponential decay function used by Wood, Rook, and others. <xref ref-type="bibr" rid="ref-5">Dematawewa, Pearson &amp; VanRaden (2007)</xref> examined models for extended lactations and found that models featuring an exponential decline of this form outperformed other candidates for lactations exceeding 305 days in length. <disp-formula id="eqn-4"><label>(4)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-4.png"/><tex-math id="tex-eqn-4"><![CDATA[\begin{eqnarray} \displaystyle D\left(t\right)=\exp (-d t).&&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-4"><mml:mstyle displaystyle="true"><mml:mi>D</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> Substitution of <xref ref-type="disp-formula" rid="eqn-3">Eqs. (3)</xref> and <xref ref-type="disp-formula" rid="eqn-4">(4)</xref> in <xref ref-type="disp-formula" rid="eqn-1">Eq. (1)</xref> yields the MilkBot<sup>®</sup> Model. <disp-formula id="eqn-5"><label>(5)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-5.png"/><tex-math id="tex-eqn-5"><![CDATA[\begin{eqnarray} \displaystyle Y\left(t\right)=a\left(1-\frac{\exp \left(\frac{c-t}{b}\right)}{2}\right)\exp (-d~t)\quad ({\text{MilkBot}}^{\textregistered }\text{ model}).&&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-5"><mml:mstyle displaystyle="true"><mml:mi>Y</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mspace class="nbsp"/><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mspace width="1em" class="quad"/><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mtext>MilkBot</mml:mtext></mml:mrow><mml:mrow><mml:mi>®</mml:mi></mml:mrow></mml:msup><mml:mtext> model</mml:mtext><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
            </p>
      </sec>
      <sec>
        <title>Experimental data</title>
        <p>Groups of 50 lactations each were drawn from 21 randomly selected dairy herds, and then compared to see whether herd effects influence lactation curve shape. Herds were selected from a large DHIA database of herds predominantly in the eastern half of the USA and containing monthly milk weights from more than six million lactations in over 17,000 herds. This is the same database used earlier for developing standard breed-parity aggregate curves (<xref ref-type="bibr" rid="ref-7">Ehrlich, 2011</xref>). Initial selection chose 1,056 herds with at least 1,000 recorded lactations between January 2005 and June 2008. From these, 21 herds were selected randomly. All data points after 305 DIM were dropped, then all lactations with fewer than 7 recorded monthly test days rejected. Lactations were divided in two parity groups, with all lactations after the first in a single group. Each group was then ordered by calving date and one lactation chosen randomly as a starting point. Lactations were then selected forward and backwards in time until 50 lactations had been collected. If a herd could not provide sufficient qualified lactations in either group, that herd was replaced by another randomly selected herd. This resulted in a set of 21 herds, each with 2 parity groups of 50 complete lactations having sequential calving dates. Lactations were all fitted using the DairySight fitting engine (<xref ref-type="bibr" rid="ref-8">Ehrlich, 2012</xref>), and parameter values recorded. Data for each herd-parity group was recorded as comma-delimited data in a single text file, then imported into Mathematica,<xref ref-type="fn" rid="peerj-54-fn1"><sup>1</sup></xref><fn id="peerj-54-fn1"><label>1</label><p>Mathematica version 8.0.1.0 from Wolfram Research.</p></fn> which was used to generate tables and figures. The number of herds chosen was set to 21 because using the cutoff <italic>p</italic> &lt; .05 in statistical testing leads to a 1/20 chance of falsely rejecting the null hypothesis. Therefore each herd could be compared to 20 others, with the expectation that on the average there would be one false-positive at <italic>p</italic> &lt; .05 for each parameter compared. Greater differences suggest greater-than-random variability between herds.</p>
      </sec>
    </sec>
    <sec>
      <title>Results and Discussion</title>
      <p>The conceptual derivation described under Methods leads to the MilkBot<sup>®</sup> model, giving daily milk yield, <italic>Y</italic>(<italic>t</italic>) as a function of DIM (<italic>t</italic>) as shown in <xref ref-type="disp-formula" rid="eqn-1">Eq. (1)</xref>. <disp-formula id="eqn-6"><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-6.png"/><tex-math id="tex-eqn-6"><![CDATA[\begin{eqnarray*} \displaystyle Y(t)=a\left(1-\frac{\exp \left(\frac{c-t}{b}\right)}{2}\right)\exp (-d t).&&\displaystyle \end{eqnarray*}]]></tex-math><mml:math id="mml-eqn-6"><mml:mstyle displaystyle="true"><mml:mi>Y</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> Model parameters <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, and <italic>d</italic> control shape and magnitude of the lactation curve. These parameters are given descriptive names based on the functions from which they were derived and their effect on the general model.</p>
      <sec>
        <title>Interpretation of parameters</title>
        <p>Parameter “<italic>a</italic>” is the <bold><italic>scale</italic></bold> parameter. It can be expressed as kilograms/day, pounds/day, or similarly. <italic>Scale</italic> can be seen as the theoretical maximum daily yield, which approaches actual peak production as <italic>ramp</italic> approaches zero. It must be a positive number. Changing the model to a different unit of measure for milk output only requires applying the appropriate conversion to the <italic>scale</italic> parameter, while all other parameter values remain unchanged. <italic>Scale</italic> can be seen as describing the magnitude of a lactation, while the other three parameters describe the curve’s shape.</p>
        <p>Parameter “<italic>b</italic>” is the <bold><italic>ramp</italic></bold> parameter, controlling the width of the Growthrate function, and so the rate of rise in milk production in early lactation. <italic>Ramp</italic> values are time, normally days, and must be a positive number. A simple thumb rule is that when <italic>t</italic> = <italic>r</italic>  <italic>a</italic>  <italic>m</italic>  <italic>p</italic>, growth in production capacity is about 82% complete.</p>
        <p>Parameter “<italic>c</italic>” is the <bold><italic>offset</italic></bold> parameter describing the offset in time between parturition and the start of lactation. <italic>Offset</italic> values are time (days), and may be positive, negative, or zero. The effect of <italic>offset</italic> is slight, except in the first few days of the lactation curve, so it is generally not possible to detect variation in the <italic>offset</italic> parameter in fitted lactations unless there are daily milk weights covering the first weeks of lactation. With a monthly interval between test points, values for the <italic>offset</italic> parameter have little value, and the model may be simplified by setting <italic>offset</italic> equal to zero or a constant near zero. Fixing <italic>offset</italic> to zero is equivalent to the common assumption that lactation begins at parturition.</p>
        <p>Parameter “<italic>d</italic>” is the <bold><italic>decay</italic></bold> parameter, controlling the rate of senescence of production capacity. <italic>Decay</italic> is inverse-time (days<sup>−1</sup>). It should be constrained to positive values under normal circumstances. An equivalent alternative expression for a first-order decay constant like the <italic>decay</italic> parameter is as a half-life, which suggests a definition of lactation persistency, which, rather than being tied to an arbitrary stage of lactation, is an attribute of the lactation as a whole. <disp-formula id="eqn-7"><label>(6)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-7.png"/><tex-math id="tex-eqn-7"><![CDATA[\begin{eqnarray} \displaystyle P e r s i s t e n c e=\frac{0.693}{d e c a y}.&&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-7"><mml:mstyle displaystyle="true"><mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>693</mml:mn></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula> By this definition <italic>decay</italic> is the time it would take for production to drop by half, if we were to ignore the growth side of the model. Since the Growth function approaches one in late lactation, <italic>decay</italic>, by this definition, is close to the actual half-life for milk production in late lactation. Fitted <italic>decay</italic> values are likely to be more normally distributed than persistence, therefore <italic>decay</italic> should be preferred for most statistical calculations, but may be converted to <italic>persistence</italic> afterwards.</p>
        <p>Mathematical manipulation of <xref ref-type="disp-formula" rid="eqn-1">Eq. (1)</xref> allows calculation of some useful results. By setting the derivative equal to zero we can calculate peak day, <italic>t</italic><sub><italic>p</italic><italic>e</italic><italic>a</italic><italic>k</italic></sub>, and from that peak milk, <italic>y</italic><sub><italic>p</italic><italic>e</italic><italic>a</italic><italic>k</italic></sub>. Note that like <italic>persistence</italic>, <italic>t</italic><sub><italic>p</italic><italic>e</italic><italic>a</italic><italic>k</italic></sub> and <italic>y</italic><sub><italic>p</italic><italic>e</italic><italic>a</italic><italic>k</italic></sub> are attributes of the lactation as a whole, and less sensitive to any single data point than metrics based on comparing individual test days. <disp-formula id="eqn-8"><label>(7)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-8.png"/><tex-math id="tex-eqn-8"><![CDATA[\begin{eqnarray} \displaystyle {t}_{p e a k}=c-b \hspace{0.167em} \log [(2~b~d)/(1~+~b~d)]&&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-8"><mml:mstyle displaystyle="true"><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi> </mml:mi><mml:mo>log</mml:mo><mml:mo>[</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mspace class="nbsp"/><mml:mi>b</mml:mi><mml:mspace class="nbsp"/><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mspace class="nbsp"/><mml:mo>+</mml:mo><mml:mspace class="nbsp"/><mml:mi>b</mml:mi><mml:mspace class="nbsp"/><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>  
               <disp-formula id="eqn-9"><label>(8)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-9.png"/><tex-math id="tex-eqn-9"><![CDATA[\begin{eqnarray} \displaystyle   \begin{array}{@{}rcl@{}} \displaystyle {y}_{p e a k}&\displaystyle =&\displaystyle Y\left({t}_{p e a k}\right)\\ \displaystyle &\displaystyle =&\displaystyle a~\exp (-d(c-b \hspace{0.167em} \mathrm{Log}[2])[a,b,c,d])\\ \displaystyle &\displaystyle &\displaystyle \times \, (1-1/2\exp ((c-(c-b \hspace{0.167em} \mathrm{Log}[2])[a,b,c,d])/b)). \end{array} &&\displaystyle \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-9"><mml:mstyle displaystyle="true"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mi>Y</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"/><mml:mtd columnalign="center"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mi>a</mml:mi><mml:mspace class="nbsp"/><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mi>d</mml:mi><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi> </mml:mi><mml:mi mathvariant="normal">Log</mml:mi><mml:mo>[</mml:mo><mml:mn>2</mml:mn><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"/><mml:mtd columnalign="center"/><mml:mtd columnalign="left"><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi> </mml:mi><mml:mi mathvariant="normal">Log</mml:mi><mml:mo>[</mml:mo><mml:mn>2</mml:mn><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mstyle></mml:math></alternatives></disp-formula>
            </p>
        <p>Cumulative production between two days can be calculated by integration, including M305. <disp-formula id="eqn-10"><label>(9)</label><alternatives><graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/eqn-10.png"/><tex-math id="tex-eqn-10"><![CDATA[\begin{eqnarray} \displaystyle \text{M305}&=&\displaystyle (a-a~\exp (-305~d))/d+(a b\exp (c/b)\\* \displaystyle &&\displaystyle \times \, (-1+\exp (-305(1/b+d))))/(2+2 b d). \end{eqnarray}]]></tex-math><mml:math id="mml-eqn-10"><mml:mstyle displaystyle="true"><mml:mtext>M305</mml:mtext><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi><mml:mspace class="nbsp"/><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>305</mml:mn><mml:mspace class="nbsp"/><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>/</mml:mo><mml:mi>b</mml:mi><mml:mo>)</mml:mo><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mo>exp</mml:mo><mml:mo>(</mml:mo><mml:mo>−</mml:mo><mml:mn>305</mml:mn><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>b</mml:mi><mml:mi>d</mml:mi><mml:mo>)</mml:mo><mml:mo>.</mml:mo></mml:mstyle></mml:math></alternatives></disp-formula>
            </p>
      </sec>
      <sec>
        <title>Comparison of herd-parity groups</title>
        <p>Herd-parity groups were compared to establish whether MilkBot<sup>®</sup> parameters or derived metrics (RMSE, M305, peak day, peak milk) could be used to detect statistical differences in lactation curves between groups. It can be inferred that if such differences exist between herds, they probably are caused by differences in management or environment, and this suggests that statistical analysis of fitted parameter values or derived metrics may be a means of monitoring herd performance and detecting abnormalities. Existing literature firmly establishes that <italic>decay</italic> should be lower in first-parity groups (higher <italic>persistence</italic> in heifers), and that there are likely to be differences in measures of magnitude such as <italic>scale</italic>, peak milk, and M305 between herds and parities. It is much less certain whether management and environment influence persistency (<italic>decay</italic>), <italic>ramp</italic>, <italic>offset</italic>, RMSE, and time of peak milk, or whether these might be fixed biologically, and insensitive to management.</p>
        <p><xref ref-type="table" rid="table-1">Table 1</xref> gives herd mean M305, predominant breed, and links to files containing data on 50 individual lactations for each of the 42 groups. <xref ref-type="table" rid="table-2">Table 2</xref> summarizes data for all herd-parity groups for each parameter or derived metric. These are overall means of the group mean and group standard deviation, and mean divergence score. A “divergence score” was calculated for each group by tabulating how many of the 20 other groups of matching parity had significantly different mean parameter value by Z-test at <italic>P</italic> &lt; .05, so that 1.0 would be the expected divergence score if there are not differences among groups, and higher scores suggest divergence is more common than would be expected from random variation.</p>
        <table-wrap id="table-1">
          <object-id pub-id-type="doi">10.7717/peerj.54/table-1</object-id>
          <label>Table 1</label>
          <caption>
            <title>Herd data.</title>
            <p>Mean M305, predominate breed, and data files for 21 randomly selected dairy herds (Supplemental Data files are available at: <xref ref-type="supplementary-material" rid="supplemental-information">Supplemental Information</xref>).</p>
          </caption>
          <alternatives>
            <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/table-1.png"/>
            <table>
              <colgroup>
                <col align="left"/>
                <col align="left"/>
                <col align="left"/>
                <col align="left"/>
                <col align="left"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left"/>
                  <th align="left">Mean M305 (kg)</th>
                  <th align="left">Breed</th>
                  <th align="left">50 parity 1 lactations</th>
                  <th align="left">50 parity 2 +lactations</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">
                    <bold>Herd A</bold>
                  </td>
                  <td align="left">6284</td>
                  <td align="left">JERSEY</td>
                  <td align="left">Supplemental Data (file 1.csv)</td>
                  <td align="left">Supplemental Data (file 2.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd B</bold>
                  </td>
                  <td align="left">7822</td>
                  <td align="left">CROSSBRED</td>
                  <td align="left">Supplemental Data (file 3.csv)</td>
                  <td align="left">Supplemental Data (file 4.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd C</bold>
                  </td>
                  <td align="left">8005</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 5.csv)</td>
                  <td align="left">Supplemental Data (file 6.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd D</bold>
                  </td>
                  <td align="left">8741</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 7.csv)</td>
                  <td align="left">Supplemental Data (file 8.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd E</bold>
                  </td>
                  <td align="left">9621</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 9.csv)</td>
                  <td align="left">Supplemental Data (file 10.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd F</bold>
                  </td>
                  <td align="left">9730</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 11.csv)</td>
                  <td align="left">Supplemental Data (file 12.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd G</bold>
                  </td>
                  <td align="left">9796</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 13.csv)</td>
                  <td align="left">Supplemental Data (file 14.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd H</bold>
                  </td>
                  <td align="left">10037</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 15.csv)</td>
                  <td align="left">Supplemental Data (file 16.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd I</bold>
                  </td>
                  <td align="left">10338</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 17.csv)</td>
                  <td align="left">Supplemental Data (file 18.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd J</bold>
                  </td>
                  <td align="left">10345</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 19.csv)</td>
                  <td align="left">Supplemental Data (file 20.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd K</bold>
                  </td>
                  <td align="left">10481</td>
                  <td align="left">JERSEY</td>
                  <td align="left">Supplemental Data (file 21.csv)</td>
                  <td align="left">Supplemental Data (file 22.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd L</bold>
                  </td>
                  <td align="left">10580</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 23.csv)</td>
                  <td align="left">Supplemental Data (file 24.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd M</bold>
                  </td>
                  <td align="left">10909</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 25.csv)</td>
                  <td align="left">Supplemental Data (file 26.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd N</bold>
                  </td>
                  <td align="left">11118</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 27.csv)</td>
                  <td align="left">Supplemental Data (file 28.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd O</bold>
                  </td>
                  <td align="left">11189</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 29.csv)</td>
                  <td align="left">Supplemental Data (file 30.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd P</bold>
                  </td>
                  <td align="left">11285</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 31.csv)</td>
                  <td align="left">Supplemental Data (file 32.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd Q</bold>
                  </td>
                  <td align="left">11332</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 33.csv)</td>
                  <td align="left">Supplemental Data (file 34.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd R</bold>
                  </td>
                  <td align="left">11521</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 35.csv)</td>
                  <td align="left">Supplemental Data (file 36.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd S</bold>
                  </td>
                  <td align="left">11715</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 37.csv)</td>
                  <td align="left">Supplemental Data (file 38.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd T</bold>
                  </td>
                  <td align="left">11987</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 39.csv)</td>
                  <td align="left">Supplemental Data (file 40.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Herd U</bold>
                  </td>
                  <td align="left">12370</td>
                  <td align="left">HOLSTEIN</td>
                  <td align="left">Supplemental Data (file 41.csv)</td>
                  <td align="left">Supplemental Data (file 42.csv)</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <table-wrap id="table-2">
          <object-id pub-id-type="doi">10.7717/peerj.54/table-2</object-id>
          <label>Table 2</label>
          <caption>
            <title>Mean MilkBot<sup>®</sup> parameter statistics for 2 parity groups in 21 randomly selected dairy herds.</title>
            <p>Means for all herds of group-mean parameter values and group standard deviation, and divergence score. Divergence score is mean number of matching parity groups (of 20 possible) with which individual groups differ by Z-test at <italic>P</italic> &lt; .05 (Supplemental Data files are available at: <xref ref-type="supplementary-material" rid="supplemental-information">Supplemental Information</xref>).</p>
          </caption>
          <alternatives>
            <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/table-2.png"/>
            <table>
              <colgroup>
                <col align="left"/>
                <col align="left"/>
                <col align="left"/>
                <col align="left"/>
              </colgroup>
              <thead>
                <tr>
                  <th align="left">
                    <bold>Metric and parity</bold>
                  </th>
                  <th align="left">
                    <bold>Mean group mean</bold>
                  </th>
                  <th align="left">
                    <bold>Mean group sd</bold>
                  </th>
                  <th align="left">
                    <bold>Mean divergence score</bold>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left">
                    <bold><italic>Scale</italic> P1 (kg)</bold>
                  </td>
                  <td align="left">38.66</td>
                  <td align="left">5.87</td>
                  <td align="left">13.9</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold><italic>Scale</italic> P2+(kg)</bold>
                  </td>
                  <td align="left">53.65</td>
                  <td align="left">9.3</td>
                  <td align="left">14.7</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold><italic>Ramp</italic> P1 (days)</bold>
                  </td>
                  <td align="left">31.43</td>
                  <td align="left">2.67</td>
                  <td align="left">10.8</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold><italic>Ramp</italic> P2+(days)</bold>
                  </td>
                  <td align="left">26.13</td>
                  <td align="left">7.66</td>
                  <td align="left">8.8</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold><italic>Offset</italic> P1 (days)</bold>
                  </td>
                  <td align="left">−0.5</td>
                  <td align="left">0</td>
                  <td align="left">0</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold><italic>Offset</italic> P2+(days)</bold>
                  </td>
                  <td align="left">−0.37</td>
                  <td align="left">0.39</td>
                  <td align="left">4.6</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold><italic>Decay</italic> P1 (day<sup>−1</sup>)</bold>
                  </td>
                  <td align="left">0.000974</td>
                  <td align="left">0.000605</td>
                  <td align="left">11.3</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold><italic>Decay</italic> P2+(day<sup>−1</sup>)</bold>
                  </td>
                  <td align="left">0.002213</td>
                  <td align="left">0.000858</td>
                  <td align="left">12.5</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>RMSE P1 (kg)</bold>
                  </td>
                  <td align="left">3.73</td>
                  <td align="left">1.51</td>
                  <td align="left">12.5</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>RMSE P2+(kg)</bold>
                  </td>
                  <td align="left">4.65</td>
                  <td align="left">2.04</td>
                  <td align="left">11.1</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>M305 P1 (kg)</bold>
                  </td>
                  <td align="left">9637</td>
                  <td align="left">1460</td>
                  <td align="left">14.6</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>M305 P2+(kg)</bold>
                  </td>
                  <td align="left">11255</td>
                  <td align="left">1811</td>
                  <td align="left">16</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>PeakDay P1</bold>
                  </td>
                  <td align="left">89.83</td>
                  <td align="left">32</td>
                  <td align="left">7.2</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>PeakDay P2+</bold>
                  </td>
                  <td align="left">59.18</td>
                  <td align="left">15.87</td>
                  <td align="left">12.8</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>PeakMilk P1 (kg)</bold>
                  </td>
                  <td align="left">33.87</td>
                  <td align="left">6.18</td>
                  <td align="left">13</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>PeakMilk P2+(kg)</bold>
                  </td>
                  <td align="left">44.86</td>
                  <td align="left">7.06</td>
                  <td align="left">15.5</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Data file P1</bold>
                  </td>
                  <td align="left">Supplemental Data (file 43.csv)</td>
                  <td align="left">Supplemental Data (file 44.csv)</td>
                  <td align="left">Supplemental Data (file 45.csv)</td>
                </tr>
                <tr>
                  <td align="left">
                    <bold>Data file P2+</bold>
                  </td>
                  <td align="left">Supplemental Data (file 46.csv)</td>
                  <td align="left">Supplemental Data (file 47.csv)</td>
                  <td align="left">Supplemental Data (file 48.csv)</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <fig id="fig-1">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-1</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Distribution of cumulative 305-day milk production (M305) for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-1.png"/>
        </fig>
        <fig id="fig-2">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-2</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Distribution of fitted MilkBot<sup>®</sup><italic>scale</italic> parameter for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-2.png"/>
        </fig>
        <fig id="fig-3">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-3</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Distribution of fitted MilkBot<sup>®</sup><italic>ramp</italic> parameter for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-3.png"/>
        </fig>
        <fig id="fig-4">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-4</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Distribution of fitted MilkBot<sup>®</sup><italic>offset</italic> parameter for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-4.png"/>
        </fig>
        <fig id="fig-5">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-5</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Distribution of fitted MilkBot<sup>®</sup><italic>decay</italic> parameter for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-5.png"/>
        </fig>
        <fig id="fig-6">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-6</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Distribution of root-mean-square fitting error (RMSE) for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-6.png"/>
        </fig>
        <fig id="fig-7">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-7</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Distribution of day of peak milk production (peak day) for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-7.png"/>
        </fig>
        <fig id="fig-8">
          <object-id pub-id-type="doi">10.7717/peerj.54/fig-8</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Distribution of peak milk production (peak milk) for herd-parity groups of 50 consecutive lactations in 21 randomly selected herds.</title>
            <p>Herds are ordered by herd average M305 with highest at the top. Diamonds show 95% confidence around mean by Z-test. Colored bars show quartiles. Whiskers show full range.</p>
          </caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="https://peerj.com/articles/54/fig-8.png"/>
        </fig>
        <p>Figures <xref ref-type="fig" rid="fig-1">1</xref>–<xref ref-type="fig" rid="fig-8">8</xref> show box-and-whiskers plots for M305, <italic>scale</italic>, <italic>ramp</italic>, <italic>offset</italic>, <italic>decay</italic>, RMSE, peak day, and peak milk. In each plot, herds are ordered by herd-average M305, with the lowest-production herd (Herd A) at the bottom. Parity groups are differentiated by color. For each group, a gray diamond gives the Z-test 95% confidence interval around the mean. Colored bars show quartiles above and below the mean, and whiskers show the full range for the group. This means that groups with diamonds that overlap vertically are not significantly different by Z-test with 95% confidence. If diamonds do not overlap, the sample means differ at <italic>p</italic> &lt; .05. Groups as small as 50 lactations with monthly test data are clearly sufficient to identify significant variability among herds, with the exception of <italic>offset</italic> and possibly peak day. <italic>Scale,</italic> M305, and peak milk seem to follow similar patterns, suggesting the correlation that is to be expected, as all are primarily measures of lactation magnitude.</p>
        <p><italic>Ramp</italic> is higher for heifers, indicating a slower rise in production after calving. It can be speculated that inter-herd variability in <italic>ramp</italic> might be influenced by transition management. Some herds (C, I, L, N, R, T) show little difference in <italic>ramp</italic> between parity groups, and since transition heifers are often managed differently from cows, it is easy to develop hypotheses on possible causes. For example, the differences could relate to whether fresh heifers are group-housed with older animals since competition with older animals might limit feed consumption in heifers, and slow growth in production capacity. That the same herds tend to show a wide range in <italic>ramp</italic> values among mature cows adds another angle for speculation and research.</p>
        <p>There is little difference in <italic>offset</italic> within or between herds, which is not surprising since only monthly milk weights were available and biologically significant differences in <italic>offset</italic> would have little effect past the first few days of lactation. Even so, in mature cows there are <italic>statistically</italic> significant differences in mean <italic>offset</italic> of as much as 0.3 days (8 h). It is very unlikely that this reflects biologically or economically significant differences in <italic>offset</italic>. Rather, with only monthly data points the fitting engine has difficulty differentiating <italic>offset</italic> from <italic>ramp</italic>, so makes the appropriate choice of attributing most but not all variability to <italic>ramp</italic>. This leads to correlation between <italic>offset</italic> and <italic>ramp</italic> as an artifact of the fitting process. One simple solution is to ignore <italic>offset</italic> when monthly test data is used. The untested possibility remains that true differences in <italic>offset</italic> would be found with daily milk weights.</p>
        <p>Heifers have markedly lower <italic>decay</italic> (greater persistency) than mature cows, but there is also considerable variation between herds. For example, persistency of mature cows in Herd K is slightly better than heifers in Herd C. The difference between cows and heifers also varies widely among herds. Factors that might influence persistency include use of rBST (recombinant bovine somatotropin), nutrition, mastitis control, and many other variables in management, environment, and genetics. These could have considerable economic importance through the effect on overall production.</p>
        <p>Distribution of RMSE is interesting because greater consistency either in the testing protocol generating production data or in actual production should lower RMSE. Mastitis, lameness, poor feed management, and many other problems would likely increase RMSE so that it may be useful as a general, if imperfect, measure of management quality and cow welfare. These are extremely difficult to measure by objective criteria, so even imperfect methodology may be useful. For example, Herd T has high production but also relatively high RMSE, which might reflect management problems, or just lower quality data collection. There are a few outliers, such as individual lactations in herds N and T with very high RMSE. For example herd N includes a single lactation with RMSE of 24.8 kg and milk weights recorded as (47.7, 83.1 84.4, 32.2, 8.2, 55.4, 77.2, 64.5, 34, 24.1) kg at approximately monthly intervals. This is obviously a highly abnormal lactation, and probably a cow with health problems. Some portion of RMSE should be attributed to bias inherent in the model design and fitting process, since no model or fitting process is perfect. This systemic error should be randomly distributed among herds, so the inter-herd variability in RMSE suggests at least that systemic error is not overwhelming. The remaining portion is sometimes called random error, reflecting the high variability that is expected even between consecutive milkings. This probably is a misnomer, since most of the variability probably has a cause, whether it is inconsistency in milking times, variability in feeds, meter error, weather, disease, or any of thousands of other possible causes. Clearly some of these are controllable, and some are not, but RMSE allows them to be measured, at least collectively.</p>
        <p>Peak milk and peak day will correlate with the parameters from which they are calculated. It is possible that they may turn out to correlate better with certain variables of interest than individual parameters, but that remains to be seen. Peak milk shows a pattern similar to <italic>scale</italic>, but with more difference between cows and heifers because of the lower <italic>decay</italic> which is characteristic of heifers. Peak day is not greatly influenced by production level, and shows relatively little variation among herds, suggesting that it is more fixed biologically, and mostly insensitive to management and environment.</p>
        <p>Peak milk is sometimes used with the thumb rule that each unit of peak milk translates to 250 units in M305, or some similar formula. This presupposes that lactation curve shape is the same in all herds, and is not influenced by whatever management changes might improve peak milk. We can get a feel for the practical effect of herd variability in curve shape by looking at its effect on this thumb rule. A rather complicated formula<xref ref-type="fn" rid="peerj-54-fn2"><sup>2</sup></xref><fn id="peerj-54-fn2"><label>2</label><p>PeakToM305Multiplier = (2 − 2 Eˆ(−305 decay) +2 decay ramp − 2 decay Eˆ(−305 decay) ramp +decay Eˆ(−305 decay − 305/ramp +offset/ramp) ramp − decay Eˆ(offset/ramp) ramp)/(2 (decay +decayˆ2 ramp)).</p></fn> can be derived to calculate how much change there would be in M305 if <italic>scale</italic> were increased enough to increase peak milk by one unit. This depends on values for the other three parameters, especially <italic>decay</italic>. For Herd C, for example, a unit of peak translates to 230 units of M305 for heifers, and 188 for cows while in Herd Q these are 267 and 221 units respectively.</p>
      </sec>
    </sec>
    <sec sec-type="conclusions">
      <title>Conclusions</title>
      <p>The semi-mechanistic derivation of the MilkBot<sup>®</sup> model assigns clear meanings to the parameter <italic>scale,</italic> as a measure of magnitude and <italic>ramp, offset</italic>, and <italic>decay</italic> parameters as measures of lactation curve shape. The <italic>decay</italic> parameter also suggests a definition of <italic>persistency</italic> expressed as a half-life called <italic>persistence</italic> that is an attribute of the lactation as a whole rather than any particular portion. Parameters may easily be used to calculate M305, peak milk, peak day, expected production at any day in the curve, or cumulative production for a portion of a lactation.</p>
      <p>The null hypothesis is rejected. Lactation curve shape does vary between herd-parity groups, in multiple ways. Those differences can be quantified statistically by fitting individual lactations to the MilkBot<sup>®</sup> model and summarizing fitted parameter values. At least some of these differences may be supposed due to management differences between groups, but little is known about possible causes.</p>
      <p>The semi-mechanistic derivation of the MilkBot<sup>®</sup> model may also suggest hypotheses that particular interventions might influence particular parameters, or metrics calculated from them such as M305, peak milk, or peak day. Fitting field or experimental data to the model allows such hypotheses to be tested. This methodology appears to be capable of quantifying effects that would be difficult or impossible to detect using only raw milk weights or M305. Similarly, parameters can be used to predict future milk in incomplete lactations. Then residuals can be summarized as a measure of the effect of short-term changes in management or environment.</p>
      <p>Nonlinear models are in many ways more difficult to work with than linear models, but may represent biology better than is possible when models are limited to linear or polynomial functions. Techniques for fitting observed data to nonlinear models vary greatly, and performance of a fitting engine often depends on characteristics of the data set being fitted as well as the model. Despite the difficulties, nonlinear models can facilitate insight into complex processes of biology, and the MilkBot<sup>®</sup> model has been shown both to predict future milk production in individual lactations with good accuracy and to be capable of quantifying what appear to be biologically and economically significant differences in lactation curve shape between groups of animals.</p>
      <p>Milk production is a very sensitive indicator of cow health, as well as being the most important economic driver for dairy farms. The DairySight fitting engine (<xref ref-type="bibr" rid="ref-8">Ehrlich, 2012</xref>) can successfully fit individual lactations from monthly test data, though significant RMSE is to be expected, returning a set of parameter values that describe the lactation as a whole. RMSE of fitted lactations can be used as a measure of consistency. By quantifying shape, magnitude, and consistency of lactations in a repeatable manner it is hoped that much future work will be enabled.</p>
    </sec>
    <sec sec-type="supplementary-material" id="supplemental-information">
      <title>Supplemental Information</title>
      <supplementary-material id="supp-1" mimetype="application" mime-subtype="zip" xlink:href="https://peerj.com/articles/54/supplementalDataS1.zip">
        <object-id pub-id-type="doi">10.7717/peerj.54/supp-1</object-id>
        <label>Supplemental Information 1</label>
        <caption>
          <title>Supplemental comma-delimited data</title>
          <p>Individual files as described in Table 1</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <sec sec-type="additional-information">
      <title>Additional Information and Declarations</title>
      <fn-group content-type="competing-interests">
        <title>Competing Interests</title>
        <fn id="conflict-1" fn-type="con">
          <p>I am a private-practice veterinarian serving dairy herds near Argyle, NY. Some work related to MilkBot was funded by a 2008 grant from USDA under their SBIR program, including a payment to DRMS for data used here and elsewhere. I have permission to publish that data, which has been anonymized. The SBIR program requires that proposals have prospects for commercialization. To that end I filed a MilkBot patent application and registered US trademarks, but I have officially abandoned the patent application and now provide free MilkBot services on the Internet. I have vague hopes of possible future income as a consultant, or in licensing software, but I have no income related to this project now or in the foreseeable future, and the MilkBot model is firmly in the public domain.</p>
        </fn>
      </fn-group>
      <fn-group content-type="author-contributions">
        <title>Author Contributions</title>
        <fn id="contribution-1" fn-type="con">
          <p><xref ref-type="contrib" rid="author-1">James L. Ehrlich</xref> conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, wrote the paper.</p>
        </fn>
      </fn-group>
    </sec>
    <ref-list content-type="authoryear">
      <title>References</title>
      <ref id="ref-1">
        <label>Animal Improvement Programs: Home (2012)</label>
        <element-citation publication-type="other">
          <comment><bold>Animal Improvement Programs: Home</bold>. 2012. Accessed December 24. <uri xlink:href="http://www.aipl.arsusda.gov/">http://www.aipl.arsusda.gov/</uri></comment>
        </element-citation>
      </ref>
      <ref id="ref-2">
        <label>Charlier et al. (2012)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Charlier</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Hostens</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Jacobs</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Van Ranst</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Duchateau</surname>
              <given-names>L</given-names>
            </name>
            <name>
              <surname>Vercruysse</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>Integrating fasciolosis control in the dry cow management: the effect of closantel treatment on milk production</article-title>
          <source>PloS One</source>
          <issue>8</issue>
          <year iso-8601-date="2012">2012</year>
          <volume>7</volume>
          <elocation-id>e43216</elocation-id>
          <pub-id pub-id-type="doi">10.1371/journal.pone.0043216</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-3">
        <label>Cole &amp; VanRaden (2006)</label>
        <element-citation publication-type="other">
          <person-group>
            <name>
              <surname>Cole</surname>
              <given-names>JB</given-names>
            </name>
            <name>
              <surname>VanRaden</surname>
              <given-names>PM</given-names>
            </name>
          </person-group>
          <year iso-8601-date="2006">2006</year>
          <comment>Genetic evaluation and best prediction of lactation persistency. <uri xlink:href="http://ddr.nal.usda.gov/handle/10113/2096">http://ddr.nal.usda.gov/handle/10113/2096</uri>
               </comment>
        </element-citation>
      </ref>
      <ref id="ref-4">
        <label>Cole, Ehrlich &amp; Null (2012)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Cole</surname>
              <given-names>JB</given-names>
            </name>
            <name>
              <surname>Ehrlich</surname>
              <given-names>JL</given-names>
            </name>
            <name>
              <surname>Null</surname>
              <given-names>DJ</given-names>
            </name>
          </person-group>
          <article-title>Short communication: projecting milk yield using best prediction and the MilkBot lactation model</article-title>
          <source>Journal of Dairy Science</source>
          <issue>7</issue>
          <year iso-8601-date="2012">2012</year>
          <volume>95</volume>
          <fpage>4041</fpage>
          <lpage>4044</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.2011-4905</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-5">
        <label>Dematawewa, Pearson &amp; VanRaden (2007)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Dematawewa</surname>
              <given-names>CMB</given-names>
            </name>
            <name>
              <surname>Pearson</surname>
              <given-names>RE</given-names>
            </name>
            <name>
              <surname>VanRaden</surname>
              <given-names>PM</given-names>
            </name>
          </person-group>
          <article-title>Modeling extended lactations of holsteins</article-title>
          <source>Journal of Dairy Science</source>
          <issue>8</issue>
          <year iso-8601-date="2007">2007</year>
          <volume>90</volume>
          <fpage>3924</fpage>
          <lpage>3936</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.2006-790</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-6">
        <label>Dijkstra et al. (1997)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Dijkstra</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>France</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Dhanoa</surname>
              <given-names>MS</given-names>
            </name>
            <name>
              <surname>Maas</surname>
              <given-names>JA</given-names>
            </name>
            <name>
              <surname>Hanigan</surname>
              <given-names>MD</given-names>
            </name>
            <name>
              <surname>Rook</surname>
              <given-names>AJ</given-names>
            </name>
            <name>
              <surname>Beever</surname>
              <given-names>DE</given-names>
            </name>
          </person-group>
          <article-title>A model to describe growth patterns of the mammary gland during pregnancy and lactation</article-title>
          <source>Journal of Dairy Science</source>
          <issue>10</issue>
          <year iso-8601-date="1997">1997</year>
          <volume>80</volume>
          <fpage>2340</fpage>
          <lpage>2354</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.S0022-0302(97)76185-X</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-7">
        <label>Ehrlich (2011)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Ehrlich</surname>
              <given-names>JL</given-names>
            </name>
          </person-group>
          <article-title>Quantifying shape of lactation curves, and benchmark curves for common dairy breeds and parities</article-title>
          <source>Bovine Practitioner</source>
          <issue>1</issue>
          <year iso-8601-date="2011">2011</year>
          <volume>45</volume>
          <fpage>88</fpage>
          <uri xlink:href="http://aabp.org/members/publications/2011/prac_feb/16-Ehrlich.pdf">http://aabp.org/members/publications/2011/prac_feb/16-Ehrlich.pdf</uri>
        </element-citation>
      </ref>
      <ref id="ref-8">
        <label>Ehrlich (2012)</label>
        <element-citation publication-type="other">
          <person-group>
            <name>
              <surname>Ehrlich</surname>
              <given-names>JL</given-names>
            </name>
          </person-group>
          <year iso-8601-date="2012">2012</year>
          <comment>DairySight |~MilkBot Services. Accessed March 7, 2013. <uri xlink:href="http://dairysight.com/milkbot/services">http://dairysight.com/milkbot/services</uri>
               </comment>
        </element-citation>
      </ref>
      <ref id="ref-9">
        <label>Hostens et al. (2012)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Hostens</surname>
              <given-names>M</given-names>
            </name>
            <name>
              <surname>Ehrlich</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Van Ranst</surname>
              <given-names>B</given-names>
            </name>
            <name>
              <surname>Opsomer</surname>
              <given-names>G</given-names>
            </name>
          </person-group>
          <article-title>On-farm evaluation of the effect of metabolic diseases on the shape of the lactation curve in dairy cows through the MilkBot lactation model</article-title>
          <source>Journal of Dairy Science</source>
          <issue>6</issue>
          <year iso-8601-date="2012">2012</year>
          <volume>95</volume>
          <fpage>2988</fpage>
          <lpage>3007</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.2011-4791</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-10">
        <label>“Interbull” (2012)</label>
        <element-citation publication-type="other">
          <comment>“<bold>Interbull</bold>”. <bold>2012</bold>. Accessed December 9. <uri xlink:href="http://www.interbull.org/">http://www.interbull.org/</uri>
               </comment>
        </element-citation>
      </ref>
      <ref id="ref-11">
        <label>Pollott (2000)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Pollott</surname>
              <given-names>GE</given-names>
            </name>
          </person-group>
          <article-title>A biological approach to lactation curve analysis for milk yield</article-title>
          <source>Journal of Dairy Science</source>
          <issue>11</issue>
          <year iso-8601-date="2000">2000</year>
          <volume>83</volume>
          <fpage>2448</fpage>
          <lpage>2458</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.S0022-0302(00)75136-8</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-12">
        <label>Rook, France &amp; Dhanoa (1993)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Rook</surname>
              <given-names>AJ</given-names>
            </name>
            <name>
              <surname>France</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Dhanoa</surname>
              <given-names>MS</given-names>
            </name>
          </person-group>
          <article-title>On the mathematical description of lactation curves</article-title>
          <source>Journal of Agricultural Science-Cambridge</source>
          <year iso-8601-date="1993">1993</year>
          <volume>121</volume>
          <fpage>97</fpage>
          <lpage>97</lpage>
          <pub-id pub-id-type="doi">10.1017/S002185960007684X</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-13">
        <label>Schaeffer et al. (2000)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Schaeffer</surname>
              <given-names>LR</given-names>
            </name>
            <name>
              <surname>Jamrozik</surname>
              <given-names>J</given-names>
            </name>
            <name>
              <surname>Kistemaker</surname>
              <given-names>GJ</given-names>
            </name>
            <name>
              <surname>Van Doormaal</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>Experience with a test-day model</article-title>
          <source>Journal of Dairy Science</source>
          <issue>5</issue>
          <year iso-8601-date="2000">2000</year>
          <volume>83</volume>
          <fpage>1135</fpage>
          <lpage>1144</lpage>
          <pub-id pub-id-type="doi">10.3168/jds.S0022-0302(00)74979-4</pub-id>
        </element-citation>
      </ref>
      <ref id="ref-14">
        <label>Wood (1967)</label>
        <element-citation publication-type="journal">
          <person-group person-group-type="author">
            <name>
              <surname>Wood</surname>
              <given-names>PDP</given-names>
            </name>
          </person-group>
          <article-title>Algebraic model of the lactation curve in cattle</article-title>
          <source>Nature</source>
          <year iso-8601-date="1967">1967</year>
          <volume>216</volume>
          <fpage>164</fpage>
          <lpage>165</lpage>
          <pub-id pub-id-type="doi">10.1038/216164a0</pub-id>
        </element-citation>
      </ref>
    </ref-list>
  </back>
</article>
